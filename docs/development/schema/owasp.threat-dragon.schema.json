{
  "$id": "https://www.threatdragon.com/docs/development/schema/owasp.threat-dragon.schema.json",
  "title": "Threat Dragon model",
  "description": "The threat models used by OWASP Threat Dragon",
  "type": "object",
  "properties": {
    "summary": {
      "description": "Threat model project meta-data",
      "type": "object",
      "properties": {
        "description": {
          "description": "Description of the threat model used for report outputs",
          "type": "string"
        },
        "id": {
          "description": "A unique identifier for this main threat model object",
          "type": "integer",
          "minimum": 0
        },
        "owner": {
          "description": "The original creator or overall owner of the model",
          "type": "string"
        },
        "tdVersion": {
          "description": "Threat Dragon version used in the model",
          "type": "string"
        },
        "title": {
          "description": "Threat model title",
          "type": "string"
        }
      },
      "required": [ "title" ]
    },
    "detail": {
      "description": "Threat model definition",
      "type": "object",
      "properties": {
        "contributors": {
          "description": "An array of contributors to the threat model project",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "description": "The name of the contributor",
                "type": "string"
              }
            }
          }
        },
        "diagrams": {
          "description": "An array of single or multiple threat dataflow diagrams",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "diagramType": {
                "description": "The methodology used by the dataflow diagram",
                "type": "string",
                "minLength": 3
              },
              "id": {
                "description": "The sequence number of the diagram",
                "type": "integer",
                "minimum": 0
              },
              "thumbnail": {
                "description": "The path to the thumbnail image",
                "type": "string"
              },
              "title": {
                "description": "The title of the dataflow diagram",
                "type": "string"
              },
              "diagramJson": {
                "description": "The dataflow diagram components",
                "type": "object",
                "properties": {
                  "size": {
                    "description": "The size of the dataflow drawing canvas",
                    "type": "object",
                    "properties": {
                      "height": {
                        "description": "The height of the dataflow drawing canvas",
                        "type": "integer",
                        "minimum": 50
                      },
                      "width": {
                        "description": "The width of the dataflow drawing canvas",
                        "type": "integer",
                        "minimum": 50
                      }
                    },
                    "required": [ "height", "width" ]
                  }
                }
              }
            }
          }
        },
        "reviewer": {
          "description": "The reviewer of the overall threat model",
          "type": "string"
        }
      },
      "required": [ "contributors", "diagrams" ]
    }
  },
  "required": [ "summary", "detail" ]
}
